<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <title>Wake up early</title>
    </head>
    <body>
        <div class="app">
            <h1><br/><img src="img/wakeupearly.png" width="200" alt="sleep"/><br/>Wake up early<br/><br/></h1>

<div id="formdiv" name="formdiv" class="formdiv">
<div>To get a personal early wake-up plan, enter your current sleep schedule:</div>
<br/>
    <div>
        <span>I usually fall asleep at</span>
        <div>
            <select id="sleep" name="sleep" title="Usual sleep time" class="boxes">
  <option value="21:00">9:00 PM (21:00)</option>
  <option value="21:30">9:30 PM (21:30)</option>
  <option value="22:00">10:00 PM (22:00)</option>
  <option value="22:30">10:30 PM (22:30)</option>
  <option selected="selected" value="23:00">11:00 PM (23:00)</option>
  <option value="23:30">11:30 PM (23:30)</option>
  <option value="0:00">midnight</option>
  <option value="0:30">12:30 AM (0:30)</option>
  <option value="1:00">1:00 AM</option>
  <option value="1:30">1:30 AM</option>
  <option value="2:00">2:00 AM</option>
  <option value="2:30">2:30 AM</option>
  <option value="3:00">3:00 AM</option>
  <option value="3:30">3:30 AM</option>
  <option value="4:00">4:00 AM</option>
  <option value="4:30">4:30 AM</option>
  <option value="5:00">5:00 AM</option>
  <option value="5:30">5:30 AM</option>
  <option value="6:00">6:00 AM</option>
  <option value="6:30">6:30 AM</option>
            </select>
        </div>
    </div>
    
    
    <div>
        <span><br/>I usually wake up without help at</span>
        <div>
            <select id="wake" name="wake" title="Usual wake time" class="boxes">
  <option value="3:00">3:00 AM</option>
  <option value="3:30">3:30 AM</option>
  <option value="4:00">4:00 AM</option>
  <option value="4:30">4:30 AM</option>
  <option value="5:00">5:00 AM</option>
  <option value="5:30">5:30 AM</option>
  <option value="6:00">6:00 AM</option>
  <option value="6:30">6:30 AM</option>
  <option value="7:00">7:00 AM</option>
  <option value="7:30">7:30 AM</option>
  <option value="8:00">8:00 AM</option>
  <option value="8:30">8:30 AM</option>
  <option selected="selected" value="9:00">9:00 AM</option>
  <option value="9:30">9:30 AM</option>
  <option value="10:00">10:00 AM</option>
  <option value="10:30">10:30 AM</option>
  <option value="11:00">11:00 AM</option>
  <option value="11:30">11:30 AM</option>
  <option value="12:00">noon</option>
            </select>
        </div>
    </div>
    
    
    <div>
        <span><br/>I want to naturally wake up ideally at</span>
        <div>
            <select id="ideal" name="ideal" title="Ideal wake time" class="boxes">
  <option value="2:00">2:00 AM</option>
  <option value="2:30">2:30 AM</option>
  <option value="3:00">3:00 AM</option>
  <option value="3:30">3:30 AM</option>
  <option value="4:00">4:00 AM</option>
  <option value="4:30">4:30 AM</option>
  <option value="5:00">5:00 AM</option>
  <option value="5:30">5:30 AM</option>
  <option value="6:00">6:00 AM</option>
  <option value="6:30">6:30 AM</option>
  <option selected="selected" value="7:00">7:00 AM</option>
  <option value="7:30">7:30 AM</option>
  <option value="8:00">8:00 AM</option>
  <option value="8:30">8:30 AM</option>
  <option value="9:00">9:00 AM</option>
  <option value="9:30">9:30 AM</option>
  <option value="10:00">10:00 AM</option>
  <option value="10:30">10:30 AM</option>
  <option value="11:00">11:00 AM</option>
  <option value="11:30">11:30 AM</option>
  <option value="12:00">noon</option>
            </select>
        </div>
    </div>
    
    
    <div>
        <span><br/>I want to shift the schedule each day</label>
        <div>
            <select id="shift" name="shift" title="Daily shift" class="boxes">
  <option value="15">15 minutes (best)</option>
  <option value="30">half an hour (faster)</option>
  <option selected="selected" value="60">one hour (fastest)</option>
            </select>
        </div>
    </div>
    
    
    <div>
        <br/><button type="button" onclick="javascript:getPlan();" class="butplan">Get plan</button><br/><br/><br/>
    </div>

</div>
    
<div id="plandiv" name="plandiv" class="plandiv">
    <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>&nbsp;<br/>
</div>



        </div>


        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>

<script>

function getPlan(){

    var dsleep  = new Date('January 2, 1970 ' + $('#sleep').val()  + ':00');
    var dwake  = new Date('January 3, 1970 ' + $('#wake').val()  + ':00');
    var dideal = new Date('January 3, 1970 ' + $('#ideal').val() + ':00');
    var shift = $('#shift').val();

    if(dideal.getTime() >= dwake.getTime())
    {
        alert('Ideal wake up should be before usual wake up.');
        return;
    }

    var txt='To wake up early, follow this scientific plan:';
    var mindiff = (dwake.getTime()-dideal.getTime())/60000;
    var zile = (mindiff/shift)+1;
    var dculcare = dsleep;
    var dsculare = dwake;
    var davoid = new Date();
    var dseekstart = new Date();
    var dseek = new Date();

    if ((shift-60==0) && (dsculare.getMinutes()-dideal.getMinutes()!=0))
    {
        dsculare.setTime(dsculare.getTime() + 60000 * 30);
        dculcare.setTime(dculcare.getTime() + 60000 * 30);
        zile = zile + 0.5;
    }

    for(var z=1; z<=zile; z++)
    {

        dsculare.setTime(dsculare.getTime() - 60000 * shift);
        dculcare.setTime(dculcare.getTime() - 60000 * shift);
        davoid.setTime(dculcare.getTime() - 60000 * 180);        //3 hours before sleep
        dseekstart.setTime(dsculare.getTime() + 60000 * shift);  //previous day sleep
        dseek.setTime(dseekstart.getTime() + 60000 * 180);       //3 hours after previous day sleep

        var culcare   = ('0' + dculcare.getHours()).slice(-2)   + ':' + ('0' + dculcare.getMinutes()).slice(-2);
        var sculare   = ('0' + dsculare.getHours()).slice(-2)   + ':' + ('0' + dsculare.getMinutes()).slice(-2);
        var avoid     = ('0' + davoid.getHours()).slice(-2)     + ':' + ('0' + davoid.getMinutes()).slice(-2);
        var seekstart = ('0' + dseekstart.getHours()).slice(-2) + ':' + ('0' + dseekstart.getMinutes()).slice(-2);
        var seek      = ('0' + dseek.getHours()).slice(-2)      + ':' + ('0' + dseek.getMinutes()).slice(-2);

        txt += '<br/><br/>Day ' + z;
        if (z!=1)
            txt += '<br/>' + 'Seek light: ' + seekstart + '-' + seek;
        if (z-zile!=0) {
            txt += '<br/>' + 'Avoid light: ' + avoid + '-' + culcare;
            txt += '<br/>' + 'Sleep: ' + culcare + '-' + sculare;
        }
    }

    //txt += '<br/><br/><button type="button" onclick="javascript:backToForm();">Return</button>';
    txt += '<br/><br/>Avoid light: Avoid as much light as convenient and safe. If sleeping, keep the room dark or wear a sleep mask. If awake, wear sunglasses.';
    txt += '<br/><br/>Sleep: Sleep is preferable during this period or earlier. Continue to avoid light during this time.';
    txt += '<br/><br/>Seek light: Get as much light as possible. Spend time outdoors or near a bright window. Light is most important at the beginning of this period.';
    txt += '<br/><br/>If you start to drift back to your previous schedule, avoid light for 2 hours before sleep and seek light for 2 hours after wake up.';
    txt += '<br/><br/><br/><br/>Disclaimer: Algorithm reviewed by <a target="_blank" href="https://www.linkedin.com/in/ebichir">Dr Elena Bichir</a>. ';
    txt += 'This application does not give or represent medical advice.<br/><br/><br/>';

    $('#plandiv').html(txt);
}


</script>

    </body>
</html>

